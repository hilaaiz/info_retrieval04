======================================================================
ğŸš€ STAGE 2: TEMPORAL INDEXING WITH SEPARATED EMBEDDING METHODS
======================================================================

ğŸ“¥ LOADING DATA...
ğŸ“‚ Loading BM25 metadata...
ğŸ“Š Loading BM25 matrices...
ğŸ§  Loading dense embeddings...

ğŸ“Š Loaded data summary:
   â€¢ Total chunks: 27946
   â€¢ Chunking methods: ['fixed_660' 'hierarchical']
   â€¢ Country distribution: {'UNKNOWN': 13979, 'US': 11332, 'UK': 2635}

ğŸ”¨ BUILDING TEMPORAL INDEX...

   â³ Processing chunking method: fixed_660
      Total chunks in this method: 3605
      â¡ï¸ Processing BM25 embeddings...
      âœ… BM25 completed: 3605 chunks added
      â¡ï¸ Processing Dense embeddings...
      âœ… Dense completed: 3605 chunks added

   â³ Processing chunking method: hierarchical
      Total chunks in this method: 24341
      â¡ï¸ Processing BM25 embeddings...
      âœ… BM25 completed: 24341 chunks added
      â¡ï¸ Processing Dense embeddings...
      âœ… Dense completed: 24341 chunks added

ğŸ’¾ SAVING OUTPUTS...
âœ… Saved temporal index to stage2_outputs/temporal_index_stage2.json
âœ… Saved metadata to stage2_outputs/temporal_index_metadata.parquet
âœ… Saved extraction log to stage2_outputs/date_extraction_analysis.csv

======================================================================
ğŸ“Š DATE EXTRACTION ANALYSIS
======================================================================
   Total chunks processed: 55892
   âœ… Successful: 55892 (100.0%)
   âŒ Failed: 0 (0.0%)

   By embedding method:
      â€¢ bm25: 27946/27946 (100.0%)
      â€¢ dense_e5_base: 27946/27946 (100.0%)

   By country:
      â€¢ UK: 5270/5270 (100.0%)
      â€¢ US: 22664/22664 (100.0%)
      â€¢ UNKNOWN: 27958/27958 (100.0%)
======================================================================


======================================================================
ğŸ“Š TEMPORAL INDEX STATISTICS
======================================================================
   Total chunks: 55892
   Chunks with valid dates: 55892 (100.0%)
   Chunks without dates: 0

   ğŸ“… Date range: 2023-06-28 to 2025-10-31
   ğŸ“ˆ Year distribution:
      2023: 12586 chunks
      2024: 23790 chunks
      2025: 19516 chunks

   ğŸŒ Country distribution:
      UK: 5270
      UNKNOWN: 27958
      US: 22664

   ğŸ”€ Chunking methods:
      fixed_660: 7210
      hierarchical: 48682

   ğŸ§  Embedding methods:
      bm25: 27946
      dense_e5_base: 27946
======================================================================

ğŸ“ˆ CREATING VISUALIZATIONS...
INFO: Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
INFO: Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
âœ… Saved temporal distribution plot to stage2_outputs/temporal_distribution.png
âœ… Saved temporal distribution by embedding method to stage2_outputs/temporal_by_embedding.png

âœ… STAGE 2 COMPLETED SUCCESSFULLY!
   ğŸ“ Output files saved to: stage2_outputs/